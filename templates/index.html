<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  
  <meta charset="UTF-8" />
  <title>Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Word Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</title>
  <style>
    body { font-family: Arial; padding: 30px; background-color: #f4f4f4; }
    .container { background: white; padding: 20px; border-radius: 10px; max-width: 700px; margin: auto; }
    input, button { width: 100%; padding: 10px; margin-top: 10px; }
    textarea { width: 100%; height: 200px; margin-top: 10px; }
    .file-results { margin-bottom: 20px; }
    .filename { font-weight: bold; margin-top: 15px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ“„ Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Word Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
    <form method="POST" action="/upload" enctype="multipart/form-data">
      <label>ğŸ”¼ Ø§Ø®ØªØ± Ù…Ù„ÙØ§Øª Word (ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ù„Ù):</label>
      <input type="file" name="docx_files" accept=".docx" multiple required>
      <label>ğŸ” Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¨Ø­Ø« (ÙŠØ¨Ø­Ø« Ø¹Ù† ÙˆØ¬ÙˆØ¯ ÙƒÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ø¹Ù‹Ø§):</label>
      <input type="text" name="search_term" placeholder="Ù…Ø«Ù„Ø§Ù‹: course title summer" required>
      <button type="submit">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨Ø­Ø«</button>
    </form>

    {% if result %}
      <hr>
      <h3>ğŸ“‹ Ø§Ù„Ù†ØªÙŠØ¬Ø©:</h3>
      <textarea readonly>{{ result }}</textarea>
    {% endif %}

    {% if results %}
      <hr>
      <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: "{{ query }}"</h3>
      {% for file in results %}
        <div class="file-results">
          <div class="filename">Ù…Ù„Ù: {{ file.filename }}</div>
          <ul>
            {% for line in file.matches %}
              <li>{{ line }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    {% endif %}
  </div>
</body>
</html>